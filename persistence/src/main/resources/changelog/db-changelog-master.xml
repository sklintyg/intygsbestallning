<databaseChangeLog
      xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

  <changeSet id="1" author="joakim anell">

    <createTable tableName="UTREDNING">
      <column name="ID" type="bigint" autoIncrement="true" startWith="1" incrementBy="1">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="BESTALLNING_ID" type="bigint">
        <constraints nullable="true"/>
      </column>
      <column name="VARDENHET_ID" type="bigint">
        <constraints nullable="true"/>
      </column>
      <column name="AVSLUT_DATUM" type="datetime">
        <constraints nullable="true"/>
      </column>
    </createTable>

    <createTable tableName="BESTALLNING">
      <column name="ID" type="bigint" autoIncrement="true" startWith="1" incrementBy="1">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="ANKOMST_DATUM" type="datetime">
        <constraints nullable="false"/>
      </column>
      <column name="STATUS" type="varchar(64)">
        <constraints nullable="false"/>
      </column>
    </createTable>

    <createTable tableName="VARDENHET">
      <column name="ID" type="bigint" autoIncrement="true" startWith="1" incrementBy="1">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="ENHET_NAMN" type="varchar(64)">
        <constraints nullable="false"/>
      </column>
      <column name="EPOST" type="varchar(64)">
        <constraints nullable="true"/>
      </column>
      <column name="STANDARD_SVAR" type="varchar(64)">
        <constraints nullable="true"/>
      </column>
    </createTable>

    <createTable tableName="HANDELSE">
      <column name="ID" type="bigint" autoIncrement="true" startWith="1" incrementBy="1">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="BESTALLNING_ID" type="bigint">
        <constraints nullable="false"/>
      </column>
      <column name="EVENT" type="varchar(64)">
        <constraints nullable="false"/>
      </column>
      <column name="SKAPAD" type="datetime">
        <constraints nullable="false"/>
      </column>
      <column name="ANVANDARE" type="varchar(64)">
        <constraints nullable="true"/>
      </column>
      <column name="BESKRIVNING" type="varchar(64)">
        <constraints nullable="false"/>
      </column>
      <column name="KOMMENTAR" type="varchar(64)">
        <constraints nullable="true"/>
      </column>
    </createTable>

    <addForeignKeyConstraint
          baseColumnNames="BESTALLNING_ID"
          baseTableName="HANDELSE"
          constraintName="HANDELSE_BESTALLNING_FK"
          referencedColumnNames="ID"
          referencedTableName="BESTALLNING"/>

  </changeSet>

  <changeSet id="2" author="cf">
    <createTable tableName="SKICKAD_NOTIFIERING">
      <column name="ID" type="bigint">
        <constraints primaryKey="true" nullable="false"/>
      </column>

      <column name="UTREDNING_ID" type="bigint">
        <constraints nullable="false"/>
      </column>

      <column name="TYP" type="varchar(64)">
        <constraints nullable="false"/>
      </column>

      <column name="MOTTAGARE" type="varchar(64)">
        <constraints nullable="false"/>
      </column>

      <column name="SKICKAD" type="datetime">
        <constraints nullable="false"/>
      </column>
    </createTable>

    <addAutoIncrement columnDataType="bigint"
        columnName="ID"
        incrementBy="1"
        startWith="1"
        tableName="SKICKAD_NOTIFIERING"/>

    <addForeignKeyConstraint
        baseTableName="SKICKAD_NOTIFIERING"
        baseColumnNames="UTREDNING_ID"
        constraintName="NOTIFIERING_TILLHOR_UTREDNING"
        referencedTableName="UTREDNING"
        referencedColumnNames="ID"/>
    <createIndex indexName="IDX_NOTIFIERING_TYP"
        tableName="SKICKAD_NOTIFIERING" unique="false">
      <column name="TYP"/>
    </createIndex>

    <createTable tableName="NOTIFIERING_PREFERENCE">

      <column name="HSA_ID" type="varchar(64)">
        <constraints primaryKey="true" nullable="false"/>
      </column>

      <column name="LANDSTING_EPOST" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
    </createTable>
  </changeSet>

</databaseChangeLog>
